# 在线更新功能使用说明

## 概述
本应用支持在线更新功能，可自动下载最新的数据库和媒体文件。

## 使用方法

### 1. 打开设置
- 点击顶部导航栏的"时光机"按钮
- 在导航面板底部点击"⚙️ 设置"

### 2. 配置更新源（首次使用）
- 在"更新源配置"中输入更新服务器地址
- 点击"保存配置"

### 3. 检查更新
- 点击"检查更新"按钮
- 系统会自动检查是否有新版本

### 4. 执行更新
- 如果有新版本，点击"开始更新"
- 等待更新完成
- 页面会自动刷新显示新内容

## 更新内容说明

### 数据库更新（SR.db）
- 直接替换本地数据库
- 自动备份原数据库为 SR.db.backup

### 媒体文件更新
- 采用增补模式
- 只下载本地不存在的文件
- 不会删除或覆盖已有文件

## 更新服务器配置

### 服务器目录结构
```
update_server/
├── version.json          # 版本信息文件
├── data/
│   └── SR.db            # 数据库文件
└── media/               # 媒体文件目录
    ├── 20240101_1_1.jpg
    └── ...
```

### version.json 格式
```json
{
  "version": "1.0.1",
  "info": "新增2024年1月数据",
  "db_size": 10485760,
  "db_hash": "abc123...",
  "media_count": 150,
  "media_files": [
    "20240101_1_1.jpg",
    "..."
  ]
}
```

## 注意事项
1. 更新前请确保网络连接正常
2. 更新过程中请勿关闭应用
3. 如更新失败，可手动恢复 data/SR.db.backup
4. 首次更新可能耗时较长，请耐心等待
